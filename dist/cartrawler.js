/*! For license information please see cartrawler.js.LICENSE.txt */
!function(e,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define([],r):"object"==typeof exports?exports.CarTrawler=r():e.CarTrawler=r()}(this,(()=>(()=>{var e={696:e=>{e.exports={prodBaseURL:"https://otageo.cartrawler.com/cartrawlerota/json",testBaseURL:"https://external-dev.cartrawler.com/cartrawlerota/json",carSizes:{1:"Mini",2:"Subcompact",3:"Economy",4:"Compact",5:"Midsize",6:"Intermediate",7:"Standard",8:"Fullsize",9:"Luxury",10:"Premium",11:"Minivan",12:"12 passenger van",13:"Moving van",14:"15 passenger van",15:"Cargo van",16:"12 foot truck",17:"20 foot truck",18:"24 foot truck",19:"26 foot truck",20:"Moped",21:"Stretch",22:"Regular",23:"Unique",24:"Exotic",25:"Small/medium truck",26:"Large truck",27:"Small SUV",28:"Medium SUV",29:"Large SUV",30:"Exotic SUV",31:"Four-wheel drive",32:"Special",33:"Mini elite",34:"Economy elite",35:"Compact elite",36:"Intermediate elite",37:"Standard elite",38:"Fullsize elite",39:"Premium elite",40:"Luxury elite",41:"Oversize",42:"50 passenger coach",43:"Convertible",44:"Estate Car",45:"5 Seat People Carrier",46:"7 Seat People Carrier",47:"9 seat minivan",48:"SUV"},currencySymbols:{USD:"$",EUR:"€",CRC:"₡",GBP:"£",ILS:"₪",INR:"₹",JPY:"¥",KRW:"₩",NGN:"₦",PHP:"₱",PLN:"zł",PYG:"₲",THB:"฿",UAH:"₴",VND:"₫"}}}},r={};function o(t){var a=r[t];if(void 0!==a)return a.exports;var i=r[t]={exports:{}};return e[t](i,i.exports,o),i.exports}o.d=(e,r)=>{for(var t in r)o.o(r,t)&&!o.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:r[t]})},o.o=(e,r)=>Object.prototype.hasOwnProperty.call(e,r),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var t={};return(()=>{"use strict";o.r(t),o.d(t,{getCars:()=>i,getIP:()=>a,ping:()=>r});var e=o(696);async function r(r){if("object"!=typeof r)return{error:"Please pass an object"};if(!r.hasOwnProperty("message"))return{error:"Please pass a message"};if("string"!=typeof r.message)return{error:'Message must be of type "string"'};let o=r.hasOwnProperty("debug")&&r.debug,t=`${o?e.testBaseURL:e.prodBaseURL}?type=OTA_PingRQ`,a={"@xmlns":"http://www.opentravel.org/OTA/2003/05","@xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","@Target":o?"Test":"Production","@Version":"1.003","@PrimaryLangID":"EN",EchoData:`${r.message}`};try{let e=await fetch(t,{method:"POST",headers:{},body:JSON.stringify(a)}),r=await e.json();return o&&console.log(r),r}catch(e){console.log(e)}}async function a(){let e={"@Target":"Production","@xmlns":"http://www.cartrawler.com/","@Version":"1.000","@PrimaryLangID":"en",POS:{Source:[{"@ERSP_UserID":"MP",RequestorID:{"@Type":"16","@ID":"122070","@ID_Context":"CARTRAWLER"}}]},Context:{SplittingDirective:"EXB"}};try{let r=await fetch("https://otageo.cartrawler.com/cartrawlerota/json?type=CT_IpToCountryRQ",{method:"POST",headers:{},body:JSON.stringify(e)});return await r.json()}catch(e){console.log(e)}}async function i(r){if(!r.hasOwnProperty("clientID"))return{error:"Please pass a valid clientID"};if(!r.hasOwnProperty("pickupdate"))return{error:"pickupdate required"};if(!r.hasOwnProperty("dropoffdate"))return{error:"dropoffdate required"};if(!r.hasOwnProperty("pickuplocation"))return{error:"pickuplocation required"};if(r.hasOwnProperty("dropofflocation")||(r.dropofflocation=r.pickuplocation),"string"!=typeof r.dropofflocation)return{error:"dropofflocation must be a string"};let o=r.hasOwnProperty("debug")&&r.debug;o&&console.log("%c CT SDK in debug mode","font-weight: bold; font-size: 22px;color: blue; text-shadow: 3px 3px 0 rgb(217,31,38) ,  6px 6px 0 rgb(5,148,68)");let t=180;r.hasOwnProperty("imageWidth")&&"number"==typeof r.imageWidth&&(t=r.imageWidth);let i="https://partner-whitelabel.cartrawler.com/";r.hasOwnProperty("deeplink")&&(i=r.deeplink,i.endsWith("/")||(i+="/"));let n=`${o?e.testBaseURL:e.prodBaseURL}?type=OTA_VehAvailRateRQ`,s={"@xmlns":"http://www.opentravel.org/OTA/2003/05","@xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","@Target":o?"Test":"Production","@Version":"1.005","@MaxResponses":200,POS:{Source:{"@ISOCurrency":"EUR",RequestorID:{"@Type":"16","@ID":r.clientID,"@ID_Context":"CARTRAWLER"}}},VehAvailRQCore:{"@Status":"Available",VehRentalCore:{"@PickUpDateTime":r.pickupdate,"@ReturnDateTime":r.dropoffdate,PickUpLocation:{"@CodeContext":"IATA","@LocationCode":r.pickuplocation},ReturnLocation:{"@CodeContext":"IATA","@LocationCode":r.dropofflocation}},DriverType:{"@Age":"30"}},VehAvailRQInfo:{"@PassengerQty":"1",Customer:{Primary:{CitizenCountryName:{"@Code":"US"}}},TPA_Extensions:{ConsumerIP:"127.0.0.123"}}};if(r.hasOwnProperty("currency")&&(s.POS.Source["@ISOCurrency"]=r.currency),r.hasOwnProperty("age")&&!isNaN(parseInt(r.age))&&(s.VehAvailRQCore.DriverType["@Age"]=r.age.toString()),r.hasOwnProperty("pax")&&!isNaN(parseInt(r.pax))&&(s.VehAvailRQInfo["@PassengerQty"]=r.pax.toString()),r.hasOwnProperty("residency")&&"string"==typeof r.residency)s.VehAvailRQInfo.Customer.Primary.CitizenCountryName["@Code"]=r.residency;else{let e=await a();o&&console.log("IP Data",e),s.VehAvailRQInfo.Customer.Primary.CitizenCountryName["@Code"]=e.CountryName["@Code"]}r.hasOwnProperty("limit")&&isNaN(parseInt(r.limit)),r.hasOwnProperty("loyalty")&&"string"==typeof r.loyalty&&(s.VehAvailRQInfo.Customer.Primary.CustLoyalty=[{"@ProgramID":r.loyalty.toUpperCase()}]),isNaN(parseFloat(r.pickuplocation))||(s.VehAvailRQCore.VehRentalCore.PickUpLocation={"@CodeContext":"GEO","#text":r.pickuplocation}),isNaN(parseFloat(r.dropofflocation))||(s.VehAvailRQCore.VehRentalCore.ReturnLocation={"@CodeContext":"GEO","#text":r.dropofflocation});try{let a=await fetch(n,{method:"POST",headers:{},body:JSON.stringify(s)}),l=await a.json();if(o&&console.log(l),l.hasOwnProperty("Errors"))return{error:`Error retreiving data from CarTrawler. Please try another search. Full Error: ${l.Errors.Error["@ShortText"]}`};i=`${i}book?ln=${l["@PrimaryLangID"].toLowerCase()}&pickupDateTime=${l.VehAvailRSCore.VehRentalCore["@PickUpDateTime"]}&returnDateTime=${l.VehAvailRSCore.VehRentalCore["@ReturnDateTime"]}&age=${s.VehAvailRQCore.DriverType["@Age"]}&clientID=${r.clientID}&ct=MP&residenceID=${s.VehAvailRQInfo.Customer.Primary.CitizenCountryName["@Code"]}&curr=${s.POS.Source["@ISOCurrency"]}&pickupID=${l.VehAvailRSCore.VehRentalCore.PickUpLocation["@LocationCode"]}&&returnID=${l.VehAvailRSCore.VehRentalCore.ReturnLocation["@LocationCode"]}`;let c=[],p=l.VehAvailRSCore.VehVendorAvails;switch(Array.isArray(p)||(p=[p.VehVendorAvail]),p.forEach((function(a,n){o&&0==n&&console.log("sample supplier",a),a.VehAvails.forEach((function(n,p){o&&0==p&&console.log("sample car",n);let u={name:n.VehAvailCore.Vehicle.VehMakeModel["@Name"],price:{sale:!1,total:n.VehAvailCore.TotalCharge["@RateTotalAmount"],currency:n.VehAvailCore.TotalCharge["@CurrencyCode"],symbol:void 0!==e.currencySymbols[n.VehAvailCore.TotalCharge["@CurrencyCode"]]?e.currencySymbols[n.VehAvailCore.TotalCharge["@CurrencyCode"]]:n.VehAvailCore.TotalCharge["@CurrencyCode"],day:(parseFloat(n.VehAvailCore.TotalCharge["@RateTotalAmount"])/parseInt(n.VehAvailCore.TPA_Extensions.Config["@Duration"])).toFixed(2),pre_paid_deposit:n.VehAvailCore.TPA_Extensions.PPDep["@Available"]},fuel_policy:n.VehAvailCore.TPA_Extensions.FuelPolicy["@Type"],cc_required:n.VehAvailCore.TPA_Extensions.CC_Info["@Required"],debit_card_accepted:n.VehAvailCore.TPA_Extensions.DebitCard["@OnArrival"],image:`${n.VehAvailCore.Vehicle.PictureURL}?w=${t}`,transmission:n.VehAvailCore.Vehicle["@TransmissionType"],size:e.carSizes.hasOwnProperty(n.VehAvailCore.Vehicle.VehClass["@Size"])?e.carSizes[n.VehAvailCore.Vehicle.VehClass["@Size"]]:"unknown",fuel:n.VehAvailCore.Vehicle["@FuelType"].toLowerCase(),doors:n.VehAvailCore.Vehicle.VehType["@DoorCount"],seats:n.VehAvailCore.Vehicle["@PassengerQuantity"],bags:n.VehAvailCore.Vehicle["@BaggageQuantity"],sipp:n.VehAvailCore.Vehicle["@Code"],airconditioned:n.VehAvailCore.Vehicle["@AirConditionInd"],supplier:{name:a.Vendor["@CompanyShortName"],image:`https://ct-supplierimage.imgix.net/car/${a.Vendor["@CompanyShortName"].toLowerCase().replace(" ","")}.pdf?output=auto&w=60&q=80&dpr=2`,terminal:"0"==a.Info.LocationDetails["@AtAirport"],location:a.Info.LocationDetails.Address["@Remark"],rating:a.Info.TPA_Extensions.hasOwnProperty("CustomerReviews")?parseFloat(a.Info.TPA_Extensions.CustomerReviews["@overall"]):0},extras:n.VehAvailCore.PricedEquips.map((e=>({name:e.Equipment.Description,price:e.Charge["@Amount"],included:e.Charge["@IncludedInRate"]}))),features:{price_freeze_available:n.VehAvailCore.TPA_Extensions.PriceFreeze["@Available"]},offers:[],deeplink:`${i}&refID=${n.VehAvailCore.Reference["@ID"]}#/vehicles`,order:parseInt(n.VehAvailCore.TPA_Extensions.Config["@Relevance"]),insruance_widget:"https://ct-demos.com/insurablock/widget.php?clientid=122070&residency=us&currency=usd&country=de&amount=100.20&language=en&startdate=2024-09-26T10:00:00&enddate=2024-09-29T10:00:00",reference:n.VehAvailCore.Reference};if(n.VehAvailCore.TPA_Extensions.hasOwnProperty("SpecialOffers")){let e=n.VehAvailCore.TPA_Extensions.SpecialOffers,r=[];Array.isArray(e)||(e=[e.Offer]),e.length>1&&e.sort(((e,r)=>parseInt(e["@Index"])-parseInt(r["@Index"]))),e.forEach((function(e,o){"monetary_discount"===e["@UIToken"]||"percentage_discount"===e["@UIToken"]?"monetary_discount"===e["@UIToken"]?(u.price.sale=!0,u.price.strikeThroughAmount=e["@Amount"],u.price.discountAmount=e["@Discount"]):u.price.percentageDiscount=e["@Value"]:r.push({name:e["@UIToken"],text:e["@ShortText"],description:e["#text"]})})),u.offers=r}n.VehAvailCore.TPA_Extensions.hasOwnProperty("Loyalty")&&(u.loyaltypoints=n.VehAvailCore.TPA_Extensions.Loyalty["@PointsEarnedPartner"]),n.VehAvailCore.TPA_Extensions.hasOwnProperty("Deposit")&&(u.price.deposit=n.VehAvailCore.TPA_Extensions.Deposit["@Amount"]),r.hasOwnProperty("book")&&(u.bookReference={"@Target":l["@Target"],"@PrimaryLangID":l["@PrimaryLangID"],POS:{Source:[{"@ERSP_UserID":"MP","@ISOCurrency":s.POS.Source["@ISOCurrency"],RequestorID:{"@Type":"16","@ID":r.clientID,"@ID_Context":"CARTRAWLER"},"@AirportCode":"DUB"}]},"@xmlns":"http://www.opentravel.org/OTA/2003/05","@xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","@Version":"3.000",VehResRQCore:{"@Status":"All",VehRentalCore:l.VehAvailRSCore.VehRentalCore,Customer:{Primary:{PersonName:{GivenName:"[FIRSTNAME]",Surname:"[SURNAME]"},Telephone:[{"@PhoneTechType":"1","@PhoneNumber":"[TELEPHONE]"}],Email:{"@EmailType":"2","#text":"[EMAIL]"},Address:{"@Type":"2",CountryName:{"@Code":"IE"}},CitizenCountryName:{"@Code":"IE"}}},DriverType:{"@Age":30}},VehResRQInfo:{RentalPaymentPref:{PaymentCard:{"@CardCode":"[CARDCODE]","@ExpireDate":"[EXPIREDATE]",CardHolderName:"[CARDHOLDERNAME]",CardNumber:{PlainText:"[CARDNUMBER]"},SeriesCode:{PlainText:"[SERIESCODE]"}}},Reference:u.reference,TPA_Extensions:{}}}),c.push(u)}))})),r.sort){case"price":c.sort(((e,r)=>e.price.total-r.price.total));break;case"rating":c.sort(((e,r)=>e.supplier.rating-r.supplier.rating));break;case"miles":case"points":case"loyalty":c.sort(((e,r)=>e.loyaltypoints-r.loyaltypoints));break;default:c.sort(((e,r)=>e.order-r.order))}r.hasOwnProperty("suppliers")&&Array.isArray(r.suppliers)&&(c=c.filter((function(e){return r.suppliers.indexOf(e.supplier.name.toLowerCase())>-1}))),r.hasOwnProperty("sizes")&&Array.isArray(r.sizes)&&(c=c.filter((function(e){return r.sizes.indexOf(e.size.toLowerCase())>-1}))),r.hasOwnProperty("unique")&&(c=c.filter(((e,r,o)=>o.findIndex((r=>r.sipp===e.sipp))===r))),c=r.hasOwnProperty("limit")&&!isNaN(parseInt(r.limit))?c.slice(0,parseInt(r.limit)):c.slice(0,20);let u={pickupName:l.VehAvailRSCore.VehRentalCore.PickUpLocation["@Name"],deeplinkURL:`${i}#/vehicles`,cars:c};return o&&console.log("SDK response:",u),u}catch(e){return console.log(e),{error:e}}}})(),t})()));